<p align="center">
  <img src="https://user-images.githubusercontent.com/11923488/209480228-98127c79-7f10-4c54-af72-fdcaf04fee6f.png" />
</p>

# Изменения в конфигурации `BAS Розничная торговля`
### Добавлено: 
  - [ ] отчет `Сверка касс и продаж`
  
     ###### *подсистемы -> Финансы*

  - [ ] общий модуль `МенеджерОборудованияКлиент`
    
```bsl
Процедура НачатьВыгрузкуДанныеВТСД_ПодключениеЗавершение(РезультатПодключения, Параметры) Экспорт
	
	Если РезультатПодключения.Результат Тогда
 
		ВходныеПараметры  = Новый Массив();
		МассивТСД = Новый Массив;
		
		Для Каждого текСтрока Из Параметры.ТаблицаВыгрузкиТоваров Цикл
			Если текСтрока.Свойство("Номенклатура") Тогда
				НаименованиеНоменклатуры = Лев(текСтрока.Номенклатура,40);
			ИначеЕсли текСтрока.Свойство("Наименование") Тогда
				НаименованиеНоменклатуры = Лев(текСтрока.Наименование,40);
			Иначе
				НаименованиеНоменклатуры = "";
			КонецЕсли;
			
			СтрокаМассиваТСД = Новый СписокЗначений;
			
			//Не массив для сохранения совместимости с обработками обслуживания.
			СтрокаМассиваТСД.Добавить(?(текСтрока.Свойство("Штрихкод")                  , Лев(текСтрока.Штрихкод,13), ""));
			СтрокаМассиваТСД.Добавить(?(текСтрока.Свойство("Номенклатура")              , НаименованиеНоменклатуры, ""));
			СтрокаМассиваТСД.Добавить(?(текСтрока.Свойство("ЕдиницаИзмерения")          , текСтрока.ЕдиницаИзмерения, ""));
			СтрокаМассиваТСД.Добавить(?(текСтрока.Свойство("ХарактеристикаНоменклатуры"), текСтрока.ХарактеристикаНоменклатуры, ""));
			СтрокаМассиваТСД.Добавить(?(текСтрока.Свойство("СерияНоменклатуры")         , текСтрока.СерияНоменклатуры, ""));
			СтрокаМассиваТСД.Добавить(?(текСтрока.Свойство("Качество")                  , текСтрока.Качество, ""));
			СтрокаМассиваТСД.Добавить(?(текСтрока.Свойство("Цена")                      , текСтрока.Цена, 0));
			СтрокаМассиваТСД.Добавить(?(текСтрока.Свойство("Количество")                , текСтрока.Количество, 0));
			СтрокаМассиваТСД.Добавить(?(текСтрока.Свойство("Артикул ")                  , текСтрока.Артикул, ""));
			МассивТСД.Добавить(СтрокаМассиваТСД);
		КонецЦикла;
				
		ВходныеПараметры.Добавить("Items");
		ВходныеПараметры.Добавить(МассивТСД);
		ВходныеПараметры.Добавить(Параметры.ПолнаяВыгрузка);
		
		Оповещение = Новый ОписаниеОповещения("НачатьВыгрузкуДанныеВТСД_ВыполнитьКомандуЗавершение", ЭтотОбъект, Параметры);
		НачатьВыполнениеКоманды(Оповещение, Параметры.ИдентификаторУстройства, "UploadDirectory", ВходныеПараметры);
		
	Иначе
		Если Параметры.ОповещениеПриЗавершении <> Неопределено Тогда
			ОписаниеОшибки = РезультатПодключения.ОписаниеОшибки;
			РезультатОперации = ПараметрыВыполненияОперацииНаОборудовании(Ложь, ОписаниеОшибки, Параметры.ИдентификаторУстройства);
			ВыполнитьОбработкуОповещения(Параметры.ОповещениеПриЗавершении, РезультатОперации);
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры
```
- [ ] общий модуль `ПолучениеОбновленийПрограммыГлобальный`
```bsl
Процедура ПолучениеОбновленийПрограммы_ПроверитьНаличиеОбновлений() Экспорт
	
	// ПолучениеОбновленийПрограммыКлиент.ПроверитьНаличиеОбновлений();
	
КонецПроцедуры
```
- [ ] общая форма `СтруктураПодчиненностиПереопределяемый`
```bsl
&НаСервере
функция ПолучитьТипОплаты(чек)
	
	строки = чек.Оплата;
	Для Каждого стр Из строки Цикл
		 рез = стр.ВидОплаты;
	КонецЦикла;	 

	Возврат рез;	
	
конецфункции

&НаСервере
функция получитьОплаты(Отч)
	
	суммакарты = 0;
	строки = отч.ОплатаПлатежнымиКартами;
	Для Каждого стр из строки Цикл
		суммакарты = суммакарты+стр.сумма;
	 Конеццикла;
	
	возврат "(Нал."+Отч.СуммаОплатыНаличных+"; Карта "+суммакарты+")";

конецфункции

// Получает представление документа для печати.
//
// Параметры:
//  Выборка  - КоллекцияДанных - структура или выборка из результатов запроса
//                 в которой содержатся дополнительные реквизиты, на основании
//                 которых можно сформировать переопределенное представление 
//                 документа для вывода в отчет "Структура подчиненности".
//
// Возвращаемое значение:
//   Строка,Неопределено   - переопределенное представление документа, или Неопределено,
//                           если для данного типа документов такое не задано.
//
Функция ПредставлениеОбъектаДляВыводаВОтчет(Выборка) Экспорт
	
	ПредставлениеОбъекта = Выборка.Представление;
	Если ТипЗнч( Выборка.Ссылка ) = Тип( "ДокументСсылка.ЧекККМ" ) Тогда
		ПредставлениеОбъекта = ПредставлениеОбъекта + "("+ПолучитьТипОплаты(Выборка.ссылка)+") " + НСтр("ru='на сумму';uk='на суму'") + " " + Выборка.СуммаДокумента + " " + Выборка.Валюта;
		Возврат	ПредставлениеОбъекта;
	ИначеЕсли ТипЗнч( Выборка.Ссылка ) = Тип( "ДокументСсылка.ОтчетОРозничныхПродажах" ) Тогда
		ПредставлениеОбъекта = ПредставлениеОбъекта + " " + НСтр("ru='на сумму';uk='на суму'") + " " + Выборка.СуммаДокумента + " " + Выборка.Валюта + получитьОплаты( выборка.ссылка );
		Возврат	ПредставлениеОбъекта;	
	КонецЕсли;			
	
	Возврат Неопределено;
	
КонецФункции

```
